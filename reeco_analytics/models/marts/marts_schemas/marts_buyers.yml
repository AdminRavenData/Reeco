version: 2

models:
  - name: marts_buyers
    config:
      materialized: table
    description: "Combines order and document data with inventory data for analysis by buyer and outlet."
    columns:
      - name: order_doc_date
        description: "The date associated with either the order update or document update."
        data_tests:
          - not_null:
              config:
                warn_if: ">1"

      - name: BUYER_NAME
        description: "Name of the buyer."
        data_tests:
          - not_null:
              config:
                warn_if: ">1"

      - name: OUTLET_NAME
        description: "Name of the outlet."

      - name: CHAINID
        description: "Identifier for the chain."


      - name: orders_count_distinct
        description: "Count of distinct orders."


      - name: DOCUMENT_count_distinct
        description: "Count of distinct documents."

      - name: total_value_ordered
        description: "Total value of items ordered."

      - name: total_value_recieved
        description: "Total value of items received."

      - name: total_value_document
        description: "Total value of items documented."


      - name: items_invenory_counted
        description: "Sum of inventory items counted."

      - name: TOTAL_VALUE_invenory
        description: "Total value of inventory items."


